<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dgit.mapper.CartCoursesMapper">
	
	<resultMap type="CartCourse" id="CartCoursesResult">
		<id property="ccNo" column="cc_no"/>
		<result property="sId" column="s_id"/>
		<result property="cNo" column="c_no"/>
		<result property="cartDate" column="cart_date"/>
		<collection property="courses" resultMap="com.dgit.mapper.CourseMapper.CourseResult"/>
	</resultMap>

	<insert id="insertCartCourse" parameterType="CartCourse">
		INSERT INTO cart_courses (s_id, c_no, cart_date) VALUES(#{sId}, #{cNo}, CURRENT_TIMESTAMP)

	</insert>

	<delete id="deleteOneCartCourse">
		DELETE FROM cart_courses WHERE cc_no=#{ccNo}
	</delete>
	
	<delete id="deleteOneCartCourseByCno">
		DELETE FROM cart_courses WHERE c_no=#{cNo}
	</delete>
	
	<delete id="deleteCartCoursesByDate">
		DELETE FROM  cart_courses WHERE cart_date &lt; now()
	</delete>
	
	<select id="selectAllCoursesBySId" resultMap="CartCoursesResult">
		SELECT ccc.cc_no, ccc.s_id, ccc.cart_date, c.* FROM cart_courses ccc
		inner join course c on ccc.c_no = c.c_no
		left outer join timetable tt on tt.c_no = c.c_no
		WHERE ccc.s_id=#{sId}
		order by ccc.cart_date
		
		<!-- SELECT ccc.s_id, ccc.cart_date FROM cart_courses ccc
		WHERE ccc.s_id=#{sId} -->
	</select>
	



	
</mapper>